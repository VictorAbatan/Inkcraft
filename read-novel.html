<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Read Novel | Inkcraft</title>

  <!-- Fonts + Styles -->
  <link rel="stylesheet" href="read-novel.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Roboto&family=Merriweather&display=swap" rel="stylesheet" />
</head>
<body>

  <!-- ✅ Scroll Progress -->
  <div id="scrollProgress">0%</div>

  <!-- ✅ Header -->
  <header>
    <h1 id="novelTitle">Loading...</h1>
  </header>

  <!-- ✅ Reader Main -->
  <main class="reading-main">
    <div class="reading-frame">
      <div id="chapterContent">
        <p>Loading chapter...</p>
      </div>

      <!-- ✅ Navigation Buttons -->
      <div class="nav-controls">
        <button id="prevChapterBtn">Previous</button>
        <button id="nextChapterBtn">Next</button>
      </div>

      <!-- ✅ Comments -->
      <section class="comments-section">
        <h3>Comments</h3>
        <ul id="commentList"></ul>
        <form id="commentForm">
          <textarea id="commentText" placeholder="Leave a comment..." required></textarea>
          <button type="submit">Post</button>
        </form>
      </section>
    </div>
  </main>

  <!-- ✅ Floating Menu Button -->
  <div class="menu-button" id="menuButton">
    <i class="fas fa-ellipsis-v"></i>
  </div>

  <!-- ✅ Menu Popup -->
  <div class="menu-popup" id="menuPopup">
    <button id="toggleFontBtn" title="Font"><i class="fas fa-font"></i></button>
    <button id="toggleSizeBtn" title="Size"><i class="fas fa-text-height"></i></button>
    <button id="themeToggleDock" title="Theme"><i class="fas fa-moon"></i></button>
    <button id="scrollToggleDock" title="Scroll/Page"><i class="fas fa-file-alt"></i></button>
    <button id="toggleChapterList" title="Chapters"><i class="fas fa-list"></i></button>
    <a href="novel-details.html" title="Back"><i class="fas fa-arrow-left"></i></a>
  </div>

  <!-- ✅ Font Popup -->
  <div id="fontPopup" class="popup-panel">
    <label>Font:</label>
    <select id="fontSelect">
      <option value="'Cormorant Garamond', serif" selected>Cormorant Garamond</option>
      <option value="'Roboto', sans-serif">Roboto</option>
      <option value="'Merriweather', serif">Merriweather</option>
      <option value="'Georgia', serif">Georgia</option>
    </select>
  </div>

  <!-- ✅ Font Size Popup -->
  <div id="sizePopup" class="popup-panel">
    <label>Size:</label>
    <input type="range" id="fontSizeRange" min="14" max="26" value="18" />
  </div>

  <!-- ✅ Chapter List Popup -->
  <div id="chapterListPopup" class="popup-panel">
    <label>Chapters:</label>
    <select id="chapterSelect">
      <option disabled selected>Loading chapters...</option>
    </select>
  </div>

  <!-- ✅ Scripts -->
  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="read-novel.js"></script>

  <!-- ✅ Inline UI Scripts -->
  <script>
    const menuBtn = document.getElementById('menuButton');
    const menuPopup = document.getElementById('menuPopup');
    const fontPopup = document.getElementById('fontPopup');
    const sizePopup = document.getElementById('sizePopup');
    const chapterListPopup = document.getElementById('chapterListPopup');
    const toggleChapterListBtn = document.getElementById('toggleChapterList');

    menuBtn.addEventListener('click', () => {
      menuPopup.classList.toggle('show');
      fontPopup.classList.remove('active');
      sizePopup.classList.remove('active');
      chapterListPopup.classList.remove('active');
    });

    document.addEventListener('click', (e) => {
      if (!menuPopup.contains(e.target) && e.target !== menuBtn) {
        menuPopup.classList.remove('show');
      }
      if (!fontPopup.contains(e.target) && e.target.id !== 'toggleFontBtn') {
        fontPopup.classList.remove('active');
      }
      if (!sizePopup.contains(e.target) && e.target.id !== 'toggleSizeBtn') {
        sizePopup.classList.remove('active');
      }
      if (!chapterListPopup.contains(e.target) && e.target !== toggleChapterListBtn) {
        chapterListPopup.classList.remove('active');
      }
    });

    toggleChapterListBtn.addEventListener('click', () => {
      chapterListPopup.classList.toggle('active');
      fontPopup.classList.remove('active');
      sizePopup.classList.remove('active');
    });
  </script>
</body>
</html>
