<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Read Novel | Inkcraft</title>

  <!-- Fonts + Styles -->
  <link rel="stylesheet" href="read-novel.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;600;700&family=Roboto&family=Merriweather&display=swap" rel="stylesheet" />
</head>
<body>

  <!-- ✅ Scroll Progress -->
  <div id="scrollProgress">0%</div>

  <!-- ✅ Header -->
  <header>
    <h1 id="novelTitle">Loading...</h1>
  </header>

  <!-- ✅ Reader Main -->
  <main class="reading-main">
    <div class="reading-frame">
      <div id="chapterContent">
        <div id="pagesContainer">
          <p>Loading chapter...</p>
        </div>
      </div>

      <!-- ✅ Author Notes -->
      <div id="authorNotes" class="author-notes">
        <!-- Filled dynamically from Firestore "notes" field -->
      </div>

      <!-- ✅ Navigation Buttons -->
      <div class="nav-controls">
        <button id="prevChapterBtn">Previous</button>
        <button id="nextChapterBtn">Next</button>
      </div>
    </div>
  </main>

  <!-- ✅ Floating Menu Button -->
  <div class="menu-button" id="menuButton">
    <i class="fas fa-ellipsis-v"></i>
  </div>

  <!-- ✅ Menu Popup -->
  <div class="menu-popup" id="menuPopup">
    <button id="toggleFontBtn" title="Font"><i class="fas fa-font"></i></button>
    <button id="toggleSizeBtn" title="Size"><i class="fas fa-text-height"></i></button>
    <button id="themeToggleDock" title="Color Scheme"><i class="fas fa-palette"></i></button>
    <button id="lineSpacingDock" title="Line Spacing"><i class="fas fa-ruler-vertical"></i></button>
    <button id="scrollToggleDock" title="Scroll/Page"><i class="fas fa-file-alt"></i></button>
    <button id="toggleChapterList" title="Chapters"><i class="fas fa-list-ul"></i></button>
    <!-- ✅ Functional back button inside popup -->
    <button id="backToDetailsBtn" title="Back to Details">
      <i class="fas fa-arrow-left"></i> 
    </button>

    <!-- ✅ Comments Section (inside popup) -->
    <div id="commentsSection" class="comments-section">
      <!-- Toggle Button -->
      <button id="toggleCommentsBtn" class="toggle-comments-btn" title="Comments">
        <i class="fas fa-comments"></i>
      </button>

      <!-- Slide-in Panel -->
      <div id="commentsContainer" class="comments-container">
        <div class="comments-header">
          <button id="closeCommentsBtn" class="close-comments-btn">
            <i class="fas fa-arrow-left"></i> Back
          </button>
          <h3>Comments</h3>
        </div>
        <div class="comments-body">
          <p>Loading comments...</p>
        </div>
      </div>
    </div>
  </div>

  <!-- ✅ Font Popup -->
  <div id="fontPopup" class="popup-panel">
    <label>Font:</label>
    <select id="fontSelect">
      <option value="'Cormorant Garamond', serif" selected>Cormorant Garamond</option>
      <option value="'Roboto', sans-serif">Roboto</option>
      <option value="'Merriweather', serif">Merriweather</option>
      <option value="'Georgia', serif">Georgia</option>
      <option value="'Times New Roman', serif">Times New Roman</option>
      <option value="'Courier New', monospace">Monospace</option>
      <option value="'Comic Sans MS', cursive">Comic Sans</option>
    </select>
  </div>

  <!-- ✅ Font Size Popup -->
  <div id="sizePopup" class="popup-panel">
    <label>Size:</label>
    <input type="range" id="fontSizeRange" min="14" max="26" value="18" />
  </div>

  <!-- ✅ Chapter List Popup -->
  <div id="chapterListPopup" class="popup-panel">
    <label>Chapters:</label>
    <select id="chapterSelect">
      <option disabled selected>Loading chapters...</option>
    </select>
  </div>

  <!-- ✅ Theme Popup (multiple backgrounds) -->
  <div id="themePopup" class="popup-panel">
    <label>Color Scheme:</label>
    <div class="theme-options">
      <button class="theme-btn" data-theme="oled">OLED Black</button>
      <button class="theme-btn" data-theme="dark">Dark</button>
      <button class="theme-btn" data-theme="light">Light</button>
      <button class="theme-btn" data-theme="sepia">Sepia</button>
      <button class="theme-btn" data-theme="burlywood">Burlywood</button>
    </div>
  </div>

  <!-- ✅ Line Spacing Popup -->
  <div id="lineSpacingPopup" class="popup-panel">
    <label>Line Spacing:</label>
    <div class="spacing-options">
      <button class="spacing-btn" data-spacing="compact">Compact</button>
      <button class="spacing-btn" data-spacing="normal">Normal</button>
      <button class="spacing-btn" data-spacing="wide">Wide</button>
    </div>
  </div>

  <!-- ✅ Scripts -->
  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="read-novel.js"></script>
</body>
</html>
